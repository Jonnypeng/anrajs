<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <script src="../../src/Base.js"></script>
    <script src="../../src/anra.common.js"></script>
    <script src="../../src/anra.svg.js"></script>
    <script src="../../src/anra.gef.js"></script>
    <script src="../../src/anra.policy.js"></script>
    <script src="../../src/anra.handle.js"></script>
    <script src="flow.js"></script>
    <script>
        window.onload = function () {
            var editor = new FlowEditor();
            var input = {
                'name':'测试编辑器',
                'nodes':[
                    {id:1, name:'CAPP', type:0, lines:[
                        {id:0, target:2, sTML:0, tTML:2 },
                        {id:1, target:3, sTML:0, tTML:2 }
                    ], bounds:[100, 150, 40, 40]},
                    {id:2, name:'MNPP', type:1, desc:'发起中转请求', lines:[
                        {id:0, target:4, sTML:0, tTML:2 },
                        {id:1, target:5, sTML:1, tTML:2 }
                    ], bounds:[250, 100, 40, 40]},
                    {id:3, name:'TMKS', type:1, desc:'处理异常', lines:[
                        {id:0, target:6, sTML:0, tTML:2 },
                        {id:1, target:7, sTML:1, tTML:2 }
                    ], bounds:[250, 200, 40, 40]},
                    {id:4, name:'CIVR', type:1, bounds:[430, 80, 30, 30]},
                    {id:5, name:'CSRS', type:2, bounds:[430, 120, 40, 40]},
                    {id:6, name:'CIVR', type:2, bounds:[430, 180, 30, 30]},
                    {id:7, name:'CSRS', type:2, bounds:[430, 220, 40, 40]}
                ]
            };

            editor.setInput(input);
            editor.createContent("my");
            var plt = document.getElementById('myPlt');
            plt.onmousedown = function () {
                var dp = editor.rootEditPart.getFigure().svg.dispatcher;

                var json = {id:8, name:'CIVR', type:2, bounds:[430, 280, 50, 50]};
                var node = new anra.gef.NodeModel();
                node.setProperties(json);
                node.id = json.id;
                node.editPartClass=EditPartRegistry[json.type];
                dp.dragTarget = new anra.gef.CreationTool(node);
                dp.mouseState = anra.EVENT.MouseDrag;
            };
        }

    </script>
    <style>
        svg text {
            -webkit-user-select: none;
            -moz-user-select: none;
            -ms-user-select: none;
            user-select: none;
        }
        svg text::selection {
            background: none;
        }
    </style>
</head>
<body>
<div id="my"
     style="position: absolute;top: 0;margin-left: -10px;width: 100%;height: 100%;background-color: rgb(13,13,13);"></div>
</body>
</html>